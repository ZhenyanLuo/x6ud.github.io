var Qi=Object.defineProperty,it=Object.defineProperties;var tt=Object.getOwnPropertyDescriptors;var Ti=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var mi=(o,i,t)=>i in o?Qi(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t,Di=(o,i)=>{for(var t in i||(i={}))rt.call(i,t)&&mi(o,t,i[t]);if(Ti)for(var t of Ti(i))ot.call(i,t)&&mi(o,t,i[t]);return o},Ei=(o,i)=>it(o,tt(i));var h=(o,i,t)=>(mi(o,typeof i!="symbol"?i+"":i,t),t);import{d as wi,o as S,c as di,a as _,g as D,h as Ai,i as Si,j as nt,k as X,l as m,n as _i,m as Ci,p as et,q as st,r as C,s as ni,w as Z,t as Ni,T as lt,u as x,v as ht,x as at,y as ct,z as gt,A as pt,B as ut,C as ft,F as $i,D as Pt,E as wt}from"./vendor.c4a19e19.js";import{_ as Ii}from"./index.f80f3610.js";import{A as zi,c as Li,a as dt,s as Mi,n as Wi,b as Oi,q as At,i as Lt,t as Mt,d as c,e as Wt,f as kt,L as R,S as vt,D as yt,B as T,g as Vt,M as bt}from"./SkeletonModelCanvas.9f87ff88.js";import{l as Ut,P as mt,a as _t}from"./PhotoDatabase.116a3c6d.js";const It={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Rt=_("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),Tt=_("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1);var Dt=wi({name:"CloseCircleOutlined",render:function(i,t){return S(),di("svg",It,[Rt,Tt])}});const Et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},St=_("path",{d:"M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:"currentColor"},null,-1);var Ct=wi({name:"WarningOutlined",render:function(i,t){return S(),di("svg",Et,[St])}});function Nt(o){const i=o.getBoundingClientRect(),t=i.right-i.left,r=i.bottom-i.top;return i.top>-r&&i.left>-t&&i.bottom<(window.innerHeight||document.documentElement.clientHeight)+r&&i.right<(window.innerWidth||document.documentElement.clientWidth)+t}function $t(o,i,t){let r,n,e=p=>i(p),s=p=>(document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r),document.removeEventListener("mouseout",n),t&&t(p));r=s,n=p=>{(!p.relatedTarget||p.relatedTarget.nodeName==="HTML")&&s(p)},document.addEventListener("mousemove",e),document.addEventListener("mouseup",r),document.addEventListener("mouseout",n),o&&e(o)}var zt=wi({props:{src:{type:String,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},imgWidth:{type:Number,required:!0},imgHeight:{type:Number,required:!0},center:{type:Object,required:!0},related:{type:Array,required:!0},landmarks:{type:Array,required:!0},flip:Boolean},setup(o){const i=D(),t=D(!1),r=Ai(function(){const s=o.flip?1-o.center[0]:o.center[0];let p=s,d=s;for(let E of o.related){const H=o.flip?1-E[0]:E[0];p=Math.min(p,H),d=Math.max(d,H)}p=Math.max(0,p),d=Math.min(1,d);const A=Math.max(Math.abs(s-p),Math.abs(d-s)),u=o.center[1];let L=u,w=u;for(let E of o.related)L=Math.min(L,E[1]),w=Math.max(w,E[1]);L=Math.max(0,L),w=Math.min(1,w);const a=Math.max(Math.abs(u-L),Math.abs(w-u)),M=(A+a)/2+Math.min(A,a)/4,W=M*2*o.imgWidth,k=M*2*o.imgHeight,v=Math.min(o.width/W,o.height/k),V=o.imgWidth*v,f=o.imgHeight*v,F=-s*V+o.width/2,N=-u*f+o.height/2;return{left:Math.round(F)+"px",top:Math.round(N)+"px",width:Math.floor(V)+"px",height:Math.floor(f)+"px",transform:o.flip?"scaleX(-1)":""}});let n=null;Si(function(){n=setInterval(e,100),e()}),nt(function(){n!=null&&clearInterval(n)});function e(){i.value&&Nt(i.value)&&(t.value=!0,n!=null&&(clearInterval(n),n=null))}return{dom:i,imgStyle:r,visible:t}}});const Ot=["src"];function Zt(o,i,t,r,n,e){return S(),X("div",{class:"image-clip",style:_i({width:o.width+"px",height:o.height+"px"}),ref:"dom"},[m("img",{src:o.src,alt:"",style:_i(o.imgStyle)},null,12,Ot)],4)}var xt=Ii(zt,[["render",Zt]]);const Ft=14,Ht=-10;var Xt=wi({components:{NIcon:Ci,NSpin:et,CloseCircleOutlined:Dt},props:{show:Boolean,id:{type:String,required:!0},regular:{type:String,required:!0},full:{type:String,required:!0},authorName:{type:String,required:!0},authorUsername:{type:String,required:!0},flip:Boolean},emits:["update:show"],setup(o,i){const t=D(!1),r=D(0),n=D(0),e=D(0),s=Ai(function(){return`https://unsplash.com/@${o.authorUsername}?utm_source=${zi}&utm_medium=referral`}),p=Ai(function(){return`https://unsplash.com/?utm_source=${zi}&utm_medium=referral`}),d=Ai(function(){const a=1.1**r.value,M=-n.value/a*(o.flip?-1:1),W=e.value/a;return{transform:`scaleX(${(o.flip?-1:1)*a}) scaleY(${a}) translateX(${M}px) translateY(${W}px)`}});st(()=>o.full,async function(){if(u(),!!o.full)try{t.value=!0,await Ut(o.full)}finally{t.value=!1}});function A(){u(),i.emit("update:show",!1)}function u(){r.value=0,n.value=0,e.value=0}function L(a){r.value-=Math.round(a.deltaY/100),r.value=Math.max(Ht,Math.min(Ft,r.value))}function w(a){if(a.button===0){a.preventDefault(),a.stopPropagation();const M=n.value,W=e.value,k=a.clientX,v=a.clientY;$t(a,function(V){n.value=M-(V.clientX-k),e.value=W+V.clientY-v})}}return{fullLoading:t,authorUrl:s,unsplashUrl:p,imgStyle:d,close:A,onWheel:L,onMouseDown:w}}});const Gt={key:0,class:"image-viewer"},qt={key:0,class:"loading"},Bt=x(" Full size image loading... "),Yt=["src"],jt={class:"link"},Kt={style:{position:"absolute",left:"5px","font-style":"normal","font-size":"12px",opacity:".5"}},Jt=x(" Photo by "),Qt=["href"],ir=x(" on "),tr=["href"];function rr(o,i,t,r,n,e){const s=C("n-spin"),p=C("close-circle-outlined"),d=C("n-icon");return S(),di(lt,{to:"body"},[o.show?(S(),X("div",Gt,[o.fullLoading?(S(),X("div",qt,[_(s,{style:{"margin-right":"8px"}}),Bt])):ni("",!0),m("div",{class:"img-wrapper",onWheel:i[1]||(i[1]=(...A)=>o.onWheel&&o.onWheel(...A))},[m("img",{src:o.fullLoading?o.regular:o.full,alt:"",style:_i(o.imgStyle),onMousedown:i[0]||(i[0]=(...A)=>o.onMouseDown&&o.onMouseDown(...A))},null,44,Yt)],32),m("div",{class:"btn-close",onClick:i[2]||(i[2]=(...A)=>o.close&&o.close(...A))},[_(d,{color:"#fff",size:"26"},{default:Z(()=>[_(p)]),_:1})]),m("div",jt,[m("div",Kt," ID: "+Ni(o.id),1),m("div",null,[Jt,m("a",{href:o.authorUrl,target:"_blank"},Ni(o.authorName),9,Qt),ir,m("a",{href:o.unsplashUrl,target:"_blank"},"Unsplash",8,tr)])])])):ni("",!0)])}var or=Ii(Xt,[["render",rr],["__scopeId","data-v-73c3dc38"]]);function nr(){var o;return!!((o=document.createElement("canvas"))==null?void 0:o.getContext("webgl2"))}function er(){return"PointerEvent"in window}function P(...o){const i=[0,0,0];for(let t of o)Wt(i,i,t);return o.length&&kt(i,i,1/o.length),i}function ei(o){return o=o%(Math.PI*2),o<0&&(o+=Math.PI*2),o}function si(o,i,t,r){return Math.atan2(r[1]-t[1],r[0]-t[0])-Math.atan2(i[1]-o[1],i[0]-o[0])}function G(o,i,t,r){const n=[i[0]-o[0],i[1]-o[1],i[2]-o[2]],e=[r[0]-t[0],r[1]-t[1],r[2]-t[2]];return c(n,e)}function b(...o){return o.reduce((i,t)=>i+t,0)/o.length}const l=function(){const o=Li(),i=Li(),t=Li(),r=Li(),n=dt();return function(e,s,p,d,A,u,L=!1){return Mi(o,d,p),L&&(o[0]=-o[0]),Wi(o,o),Mi(i,s,e),L&&(i[0]=-i[0]),Oi(t,i,o),Wi(t,t),At(n,t,o),Lt(n,n),Mi(r,u,A),L&&(r[0]=-r[0]),Wi(r,r),Mt([0,0,0],r,n)}}();function g(o,i){const t=Mi([0,0,0],i,o);return Wi(t,t),t}function y(o,i){return[(o[0]*2-1)*i,-o[1]*2+1,o[2]*i]}function U(o){return[-o[0],o[1],o[2]]}function li(o,i){const t=[0,0,0];return Oi(t,o,i),t}const ki=Math.PI/180*45;class sr{constructor(){h(this,"targetUp",[0,0,0]);h(this,"targetRight",[0,0,0]);h(this,"targetUpMirror",[0,0,0]);h(this,"targetRightMirror",[0,0,0])}prepare(i){this.targetUp=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),this.targetRight=g(i.rightUpperArm.originViewPosition,i.leftUpperArm.originViewPosition),this.targetUpMirror=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),this.targetRightMirror=g(U(i.leftUpperArm.originViewPosition),U(i.rightUpperArm.originViewPosition))}match(i){const t=i.normalizedLandmarks;if(Math.min(t[12].visibility,t[11].visibility,t[24].visibility,t[23].visibility)<R)return null;const n=i.width/i.height,e=y(t[11].point,n),s=y(t[12].point,n),p=y(t[23].point,n),d=y(t[24].point,n),A=g(P(p,d),P(e,s)),u=g(s,e),L=c(this.targetUp,A),w=c(this.targetRight,u),a=(Math.PI-L)*(Math.PI-w),M=c(this.targetUpMirror,A),W=c(this.targetRightMirror,u),k=(Math.PI-M)*(Math.PI-W);let v=0,V=!1;if(L<=ki&&w<=ki&&a>k)v=a;else if(M<=ki&&W<=ki)v=k,V=!0;else return null;return{score:v,center:P(t[11].point,t[12].point),related:[t[11].point,t[12].point,t[13].point,t[14].point,P(t[24].point,t[23].point,t[12].point,t[11].point)],flip:V}}}const vi=Math.PI/180*45;class lr{constructor(){h(this,"targetUp",[0,0,0]);h(this,"targetRight",[0,0,0]);h(this,"targetUpMirror",[0,0,0]);h(this,"targetRightMirror",[0,0,0])}prepare(i){this.targetUp=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),this.targetRight=g(i.rightThigh.originViewPosition,i.leftThigh.originViewPosition),this.targetUpMirror=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),this.targetRightMirror=g(U(i.leftThigh.originViewPosition),U(i.rightThigh.originViewPosition))}match(i){const t=i.normalizedLandmarks;if(Math.min(t[12].visibility,t[11].visibility,t[24].visibility,t[23].visibility)<R)return null;const n=i.width/i.height,e=y(t[11].point,n),s=y(t[12].point,n),p=y(t[23].point,n),d=y(t[24].point,n),A=g(P(p,d),P(e,s)),u=g(d,p),L=c(this.targetUp,A),w=c(this.targetRight,u),a=(Math.PI-L)*(Math.PI-w),M=c(this.targetUpMirror,A),W=c(this.targetRightMirror,u),k=(Math.PI-M)*(Math.PI-W);let v=0,V=!1;if(L<=vi&&w<=vi&&a>k)v=a;else if(M<=vi&&W<=vi)v=k,V=!0;else return null;return{score:v,center:P(t[23].point,t[24].point),related:[t[23].point,t[24].point,t[25].point,t[26].point,P(t[24].point,t[23].point,t[12].point,t[11].point)],flip:V}}}const hi=Math.PI/180*45,yi=Math.PI/180*45,ai=[0,0,1];class Zi{constructor(i){h(this,"isLeft");h(this,"upperArmZAxisAngle",0);h(this,"lowerArmZAxisAngle",0);h(this,"elbowAngle",0);h(this,"elbowViewAngle",0);h(this,"upperArmLocalDir",[0,0,0]);h(this,"upperArmLocalDirMirror",[0,0,0]);h(this,"trunkForward",[0,0,0]);h(this,"trunkForwardMirror",[0,0,0]);this.isLeft=i}prepare(i){let t=i.rightUpperArm.originViewPosition,r=i.rightUpperArm.controlPointViewPosition,n=i.rightLowerArm.controlPointViewPosition;this.isLeft&&(t=i.leftUpperArm.originViewPosition,r=i.leftUpperArm.controlPointViewPosition,n=i.leftLowerArm.controlPointViewPosition);const e=g(t,r),s=g(r,n);this.upperArmZAxisAngle=c(ai,e),this.lowerArmZAxisAngle=c(ai,s),this.elbowAngle=c(e,s),this.elbowViewAngle=ei(si(r,t,r,n))-Math.PI,this.isLeft?(this.upperArmLocalDir=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition),this.upperArmLocalDirMirror=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,!0)):(this.upperArmLocalDir=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition),this.upperArmLocalDirMirror=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,!0));const p=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),d=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),A=g(i.rightUpperArm.originViewPosition,i.leftUpperArm.originViewPosition),u=g(U(i.leftUpperArm.originViewPosition),U(i.rightUpperArm.originViewPosition));this.trunkForward=li(A,p),this.trunkForwardMirror=li(u,d)}match(i){const t=i.width/i.height,r=i.normalizedLandmarks,n=i.worldLandmarks,e=y(r[11].point,t),s=y(r[12].point,t),p=y(r[23].point,t),d=y(r[24].point,t),A=g(P(p,d),P(e,s)),u=g(s,e),L=li(u,A),w=Math.min(b(r[11].visibility,r[13].visibility),b(r[13].visibility,r[15].visibility));let a=1/0,M=1/0,W=1/0,k=1/0,v=1/0,V=1/0;if(w>=R){const $=e,I=y(r[13].point,t),z=y(r[15].point,t),Y=g($,I),j=g(I,z),K=c(ai,Y),J=c(ai,j);a=Math.abs(this.upperArmZAxisAngle-K),M=Math.abs(this.lowerArmZAxisAngle-J);const Q=n[11].point,O=n[13].point,ii=n[15].point,ti=G(Q,O,O,ii);W=Math.abs(this.elbowAngle-ti);const ri=ei(si(I,$,I,z))-Math.PI;k=Math.abs(this.elbowViewAngle-ri*(this.isLeft?1:-1));const oi=l(n[12].point,n[11].point,n[23].point,n[11].point,n[11].point,n[13].point);v=c(oi,this.isLeft?this.upperArmLocalDir:this.upperArmLocalDirMirror),V=c(L,this.isLeft?this.trunkForward:this.trunkForwardMirror)}const f=(Math.PI-a)*(Math.PI-M)*(Math.PI-W)*(Math.PI*2-k)*(Math.PI-v)*(Math.PI-V),F=Math.min(b(r[12].visibility,r[14].visibility),b(r[14].visibility,r[16].visibility));let N=1/0,E=1/0,H=1/0,q=1/0,B=1/0,fi=1/0;if(F>=R){const $=s,I=y(r[14].point,t),z=y(r[16].point,t),Y=g($,I),j=g(I,z),K=c(ai,Y),J=c(ai,j);N=Math.abs(this.upperArmZAxisAngle-K),E=Math.abs(this.lowerArmZAxisAngle-J);const Q=n[12].point,O=n[14].point,ii=n[16].point,ti=G(Q,O,O,ii);H=Math.abs(this.elbowAngle-ti);const ri=ei(si(I,$,I,z))-Math.PI;q=Math.abs(this.elbowViewAngle-ri*(this.isLeft?-1:1));const oi=l(n[11].point,n[12].point,n[24].point,n[12].point,n[12].point,n[14].point);B=c(oi,this.isLeft?this.upperArmLocalDirMirror:this.upperArmLocalDir),fi=c(L,this.isLeft?this.trunkForwardMirror:this.trunkForward)}const Pi=(Math.PI-N)*(Math.PI-E)*(Math.PI-H)*(Math.PI*2-q)*(Math.PI-B)*(Math.PI-fi);return f>=Pi&&a<=hi&&M<=hi&&W<=yi&&k<=hi&&v<=yi?{score:f,center:r[13].point,related:[r[11].point,r[15].point],flip:!this.isLeft}:N<=hi&&E<=hi&&H<=yi&&q<=hi&&B<=yi?{score:Pi,center:r[14].point,related:[r[12].point,r[16].point],flip:this.isLeft}:null}}const ci=Math.PI/180*45;class xi{constructor(i){h(this,"isLeft");h(this,"elbowAngle",0);h(this,"upperArmLocalDir",[0,0,0]);h(this,"upperArmLocalDirMirror",[0,0,0]);h(this,"lowerArmLocalDir",[0,0,0]);h(this,"lowerArmLocalDirMirror",[0,0,0]);this.isLeft=i}prepare(i){let t=i.rightUpperArm.originWorldPosition,r=i.rightUpperArm.controlPointWorldPosition,n=i.rightLowerArm.controlPointWorldPosition;this.isLeft&&(t=i.leftUpperArm.originWorldPosition,r=i.leftUpperArm.controlPointWorldPosition,n=i.leftLowerArm.controlPointWorldPosition);const e=g(t,r),s=g(r,n);this.elbowAngle=c(e,s),this.isLeft?(this.upperArmLocalDir=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition),this.upperArmLocalDirMirror=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,!0),this.lowerArmLocalDir=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftLowerArm.originWorldPosition,i.leftLowerArm.controlPointWorldPosition),this.lowerArmLocalDirMirror=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftLowerArm.originWorldPosition,i.leftLowerArm.controlPointWorldPosition,!0)):(this.upperArmLocalDir=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition),this.upperArmLocalDirMirror=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,!0),this.lowerArmLocalDir=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightLowerArm.originWorldPosition,i.rightLowerArm.controlPointWorldPosition),this.lowerArmLocalDirMirror=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightLowerArm.originWorldPosition,i.rightLowerArm.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=Math.min(b(t[11].visibility,t[13].visibility),b(t[13].visibility,t[15].visibility));let e=1/0,s=1/0,p=1/0;if(n>=R){const M=t[11].point,W=t[13].point,k=t[15].point,v=G(M,W,W,k);e=Math.abs(this.elbowAngle-v);const V=l(t[12].point,t[11].point,t[23].point,t[11].point,t[11].point,t[13].point);s=c(V,this.isLeft?this.upperArmLocalDir:this.upperArmLocalDirMirror);const f=l(t[12].point,t[11].point,t[13].point,t[11].point,t[13].point,t[15].point);p=c(f,this.isLeft?this.lowerArmLocalDir:this.lowerArmLocalDirMirror)}const d=(Math.PI-e)*(Math.PI-s)*(Math.PI-p),A=Math.min(b(t[12].visibility,t[14].visibility),b(t[14].visibility,t[16].visibility));let u=1/0,L=1/0,w=1/0;if(A>=R){const M=t[12].point,W=t[14].point,k=t[16].point,v=G(M,W,W,k);u=Math.abs(this.elbowAngle-v);const V=l(t[11].point,t[12].point,t[24].point,t[12].point,t[12].point,t[14].point);L=c(V,this.isLeft?this.upperArmLocalDirMirror:this.upperArmLocalDir);const f=l(t[11].point,t[12].point,t[14].point,t[12].point,t[14].point,t[16].point);w=c(f,this.isLeft?this.lowerArmLocalDirMirror:this.lowerArmLocalDir)}const a=(Math.PI-u)*(Math.PI-L)*(Math.PI-w);return d>=a&&e<=ci&&s<=ci&&p<=ci?{score:d,center:r[13].point,related:[r[11].point,r[15].point],flip:!this.isLeft}:u<=ci&&L<=ci&&w<=ci?{score:a,center:r[14].point,related:[r[12].point,r[16].point],flip:this.isLeft}:null}}const Fi=Math.PI/180*30,Vi=Math.PI/180*45;class Hi{constructor(i){h(this,"isLeft");h(this,"thighLocalDir",[0,0,0]);h(this,"thighLocalDirMirror",[0,0,0]);h(this,"trunkViewUp",[0,0,0]);h(this,"trunkViewRight",[0,0,0]);h(this,"trunkViewUpMirror",[0,0,0]);h(this,"trunkViewRightMirror",[0,0,0]);this.isLeft=i}prepare(i){this.trunkViewUp=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),this.trunkViewUpMirror=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),this.trunkViewRight=g(i.rightThigh.originViewPosition,i.leftThigh.originViewPosition),this.trunkViewRightMirror=g(U(i.leftThigh.originViewPosition),U(i.rightThigh.originViewPosition)),this.isLeft?(this.thighLocalDir=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,!0)):(this.thighLocalDir=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=i.width/i.height,e=y(r[11].point,n),s=y(r[12].point,n),p=y(r[23].point,n),d=y(r[24].point,n),A=g(P(p,d),P(e,s)),u=g(s,e),L=Math.min(b(t[11].visibility,t[23].visibility,t[24].visibility),b(t[23].visibility,t[25].visibility));let w=1/0,a=1/0,M=1/0;if(L>=R){const f=l(t[24].point,t[23].point,t[23].point,t[11].point,t[23].point,t[25].point);w=c(f,this.isLeft?this.thighLocalDir:this.thighLocalDirMirror),a=c(A,this.isLeft?this.trunkViewUp:this.trunkViewUpMirror),M=c(u,this.isLeft?this.trunkViewRight:this.trunkViewRightMirror)}const W=Math.min(b(t[12].visibility,t[24].visibility,t[23].visibility),b(t[24].visibility,t[26].visibility));let k=1/0,v=1/0,V=1/0;if(W>=R){const f=l(t[23].point,t[24].point,t[24].point,t[12].point,t[24].point,t[26].point);k=c(f,this.isLeft?this.thighLocalDirMirror:this.thighLocalDir),v=c(A,this.isLeft?this.trunkViewUpMirror:this.trunkViewUp),V=c(u,this.isLeft?this.trunkViewRightMirror:this.trunkViewRight)}return w<k&&w<=Fi&&a<=Vi&&M<=Vi?{score:(Math.PI-w)*(Math.PI-a)*(Math.PI-M),center:r[23].point,related:[r[24].point,r[25].point,P(r[23].point,r[11].point)],flip:!this.isLeft}:k<=Fi&&v<=Vi&&V<=Vi?{score:(Math.PI-k)*(Math.PI-v)*(Math.PI-V),center:r[24].point,related:[r[23].point,r[26].point,P(r[24].point,r[12].point)],flip:this.isLeft}:null}}const Xi=Math.PI/180*30;class Gi{constructor(i){h(this,"isLeft");h(this,"thighLocalDir",[0,0,0]);h(this,"thighLocalDirMirror",[0,0,0]);this.isLeft=i}prepare(i){this.isLeft?(this.thighLocalDir=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,!0)):(this.thighLocalDir=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=i.width/i.height,e=y(r[11].point,n),s=y(r[12].point,n),p=y(r[23].point,n),d=y(r[24].point,n);g(P(p,d),P(e,s)),g(s,e);const A=Math.min(b(t[11].visibility,t[23].visibility,t[24].visibility),b(t[23].visibility,t[25].visibility));let u=1/0;if(A>=R){const a=l(t[24].point,t[23].point,t[23].point,t[11].point,t[23].point,t[25].point);u=c(a,this.isLeft?this.thighLocalDir:this.thighLocalDirMirror)}const L=Math.min(b(t[12].visibility,t[24].visibility,t[23].visibility),b(t[24].visibility,t[26].visibility));let w=1/0;if(L>=R){const a=l(t[23].point,t[24].point,t[24].point,t[12].point,t[24].point,t[26].point);w=c(a,this.isLeft?this.thighLocalDirMirror:this.thighLocalDir)}return u<w&&u<=Xi?{score:Math.PI-u,center:r[23].point,related:[r[24].point,r[25].point,P(r[23].point,r[11].point)],flip:!this.isLeft}:w<=Xi?{score:Math.PI-w,center:r[24].point,related:[r[23].point,r[26].point,P(r[24].point,r[12].point)],flip:this.isLeft}:null}}const gi=Math.PI/180*45,bi=Math.PI/180*45,pi=[0,0,1];class qi{constructor(i){h(this,"isLeft");h(this,"thighZAxisAngle",0);h(this,"calfZAxisAngle",0);h(this,"kneeAngle",0);h(this,"kneeViewAngle",0);h(this,"thighLocalDir",[0,0,0]);h(this,"thighLocalDirMirror",[0,0,0]);h(this,"trunkForward",[0,0,0]);h(this,"trunkForwardMirror",[0,0,0]);this.isLeft=i}prepare(i){let t=i.rightThigh.originViewPosition,r=i.rightThigh.controlPointViewPosition,n=i.rightCalf.controlPointViewPosition;this.isLeft&&(t=i.leftThigh.originViewPosition,r=i.leftThigh.controlPointViewPosition,n=i.leftCalf.controlPointViewPosition);const e=g(t,r),s=g(r,n);this.thighZAxisAngle=c(pi,e),this.calfZAxisAngle=c(pi,s),this.kneeAngle=c(e,s),this.kneeViewAngle=ei(si(r,t,r,n))-Math.PI,this.isLeft?(this.thighLocalDir=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,!0)):(this.thighLocalDir=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,!0));const p=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),d=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),A=g(i.rightThigh.originViewPosition,i.leftThigh.originViewPosition),u=g(U(i.leftThigh.originViewPosition),U(i.rightThigh.originViewPosition));this.trunkForward=li(A,p),this.trunkForwardMirror=li(u,d)}match(i){const t=i.width/i.height,r=i.normalizedLandmarks,n=i.worldLandmarks,e=y(r[11].point,t),s=y(r[12].point,t),p=y(r[23].point,t),d=y(r[24].point,t),A=g(P(p,d),P(e,s)),u=g(s,e),L=li(u,A),w=Math.min(b(r[23].visibility,r[25].visibility),b(r[25].visibility,r[27].visibility));let a=1/0,M=1/0,W=1/0,k=1/0,v=1/0,V=1/0;if(w>=R){const $=p,I=y(r[25].point,t),z=y(r[27].point,t),Y=g($,I),j=g(I,z),K=c(pi,Y),J=c(pi,j);a=Math.abs(this.thighZAxisAngle-K),M=Math.abs(this.calfZAxisAngle-J);const Q=n[23].point,O=n[25].point,ii=n[27].point,ti=G(Q,O,O,ii);W=Math.abs(this.kneeAngle-ti);const ri=ei(si(I,$,I,z))-Math.PI;k=Math.abs(this.kneeViewAngle-ri*(this.isLeft?1:-1));const oi=l(n[24].point,n[23].point,n[23].point,n[11].point,n[23].point,n[25].point);v=c(oi,this.isLeft?this.thighLocalDir:this.thighLocalDirMirror),V=c(L,this.isLeft?this.trunkForward:this.trunkForwardMirror)}const f=(Math.PI-a)*(Math.PI-M)*(Math.PI-W)*(Math.PI*2-k)*(Math.PI-v)*(Math.PI-V),F=Math.min(b(r[24].visibility,r[26].visibility),b(r[26].visibility,r[28].visibility));let N=1/0,E=1/0,H=1/0,q=1/0,B=1/0,fi=1/0;if(F>=R){const $=d,I=y(r[26].point,t),z=y(r[28].point,t),Y=g($,I),j=g(I,z),K=c(pi,Y),J=c(pi,j);N=Math.abs(this.thighZAxisAngle-K),E=Math.abs(this.calfZAxisAngle-J);const Q=n[24].point,O=n[26].point,ii=n[28].point,ti=G(Q,O,O,ii);H=Math.abs(this.kneeAngle-ti);const ri=ei(si(I,$,I,z))-Math.PI;q=Math.abs(this.kneeViewAngle-ri*(this.isLeft?-1:1));const oi=l(n[23].point,n[24].point,n[24].point,n[12].point,n[24].point,n[26].point);B=c(oi,this.isLeft?this.thighLocalDirMirror:this.thighLocalDir),fi=c(L,this.isLeft?this.trunkForwardMirror:this.trunkForward)}const Pi=(Math.PI-N)*(Math.PI-E)*(Math.PI-H)*(Math.PI*2-q)*(Math.PI-B)*(Math.PI-fi);return f>=Pi&&a<=gi&&M<=gi&&W<=bi&&k<=gi&&v<=bi?{score:f,center:r[25].point,related:[r[23].point,r[27].point],flip:!this.isLeft}:N<=gi&&E<=gi&&H<=bi&&q<=gi&&B<=bi?{score:Pi,center:r[26].point,related:[r[24].point,r[28].point],flip:this.isLeft}:null}}const ui=Math.PI/180*45;class Bi{constructor(i){h(this,"isLeft");h(this,"kneeAngle",0);h(this,"thighLocalDir",[0,0,0]);h(this,"thighLocalDirMirror",[0,0,0]);h(this,"calfLocalDir",[0,0,0]);h(this,"calfLocalDirMirror",[0,0,0]);this.isLeft=i}prepare(i){let t=i.rightThigh.originWorldPosition,r=i.rightThigh.controlPointWorldPosition,n=i.rightCalf.controlPointWorldPosition;this.isLeft&&(t=i.leftThigh.originWorldPosition,r=i.leftThigh.controlPointWorldPosition,n=i.leftCalf.controlPointWorldPosition);const e=g(t,r),s=g(r,n);this.kneeAngle=c(e,s),this.isLeft?(this.thighLocalDir=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,!0),this.calfLocalDir=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftCalf.originWorldPosition,i.leftCalf.controlPointWorldPosition),this.calfLocalDirMirror=l(i.rightThigh.originWorldPosition,i.leftThigh.originWorldPosition,i.leftThigh.controlPointWorldPosition,i.leftThigh.originWorldPosition,i.leftCalf.originWorldPosition,i.leftCalf.controlPointWorldPosition,!0)):(this.thighLocalDir=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition),this.thighLocalDirMirror=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,!0),this.calfLocalDir=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightCalf.originWorldPosition,i.rightCalf.controlPointWorldPosition),this.calfLocalDirMirror=l(i.leftThigh.originWorldPosition,i.rightThigh.originWorldPosition,i.rightThigh.controlPointWorldPosition,i.rightThigh.originWorldPosition,i.rightCalf.originWorldPosition,i.rightCalf.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=Math.min(b(t[23].visibility,t[25].visibility),b(t[25].visibility,t[27].visibility));let e=1/0,s=1/0,p=1/0;if(n>=R){const M=t[23].point,W=t[25].point,k=t[27].point,v=G(M,W,W,k);e=Math.abs(this.kneeAngle-v);const V=l(t[24].point,t[23].point,t[23].point,t[11].point,t[23].point,t[25].point);s=c(V,this.isLeft?this.thighLocalDir:this.thighLocalDirMirror);const f=l(t[24].point,t[23].point,t[25].point,t[23].point,t[25].point,t[27].point);p=c(f,this.isLeft?this.calfLocalDir:this.calfLocalDirMirror)}const d=(Math.PI-e)*(Math.PI-s)*(Math.PI-p),A=Math.min(b(t[24].visibility,t[26].visibility),b(t[26].visibility,t[28].visibility));let u=1/0,L=1/0,w=1/0;if(A>=R){const M=t[24].point,W=t[26].point,k=t[28].point,v=G(M,W,W,k);u=Math.abs(this.kneeAngle-v);const V=l(t[23].point,t[24].point,t[24].point,t[12].point,t[24].point,t[26].point);L=c(V,this.isLeft?this.thighLocalDirMirror:this.thighLocalDir);const f=l(t[23].point,t[24].point,t[26].point,t[24].point,t[26].point,t[28].point);w=c(f,this.isLeft?this.calfLocalDirMirror:this.calfLocalDir)}const a=(Math.PI-u)*(Math.PI-L)*(Math.PI-w);return d>=a&&e<=ui&&s<=ui&&p<=ui?{score:d,center:r[25].point,related:[r[23].point,r[27].point],flip:!this.isLeft}:u<=ui&&L<=ui&&w<=ui?{score:a,center:r[26].point,related:[r[24].point,r[28].point],flip:this.isLeft}:null}}const Yi=Math.PI/180*30,Ui=Math.PI/180*45;class ji{constructor(i){h(this,"isLeft");h(this,"shoulderLocalDir",[0,0,0]);h(this,"shoulderLocalDirMirror",[0,0,0]);h(this,"trunkViewUp",[0,0,0]);h(this,"trunkViewRight",[0,0,0]);h(this,"trunkViewUpMirror",[0,0,0]);h(this,"trunkViewRightMirror",[0,0,0]);this.isLeft=i}prepare(i){this.trunkViewUp=g(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition),P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition)),this.trunkViewUpMirror=g(U(P(i.leftThigh.originViewPosition,i.rightThigh.originViewPosition)),U(P(i.leftUpperArm.originViewPosition,i.rightUpperArm.originViewPosition))),this.trunkViewRight=g(i.rightUpperArm.originViewPosition,i.leftUpperArm.originViewPosition),this.trunkViewRightMirror=g(U(i.leftUpperArm.originViewPosition),U(i.rightUpperArm.originViewPosition)),this.isLeft?(this.shoulderLocalDir=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition),this.shoulderLocalDirMirror=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,!0)):(this.shoulderLocalDir=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition),this.shoulderLocalDirMirror=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=i.width/i.height,e=y(r[11].point,n),s=y(r[12].point,n),p=y(r[23].point,n),d=y(r[24].point,n),A=g(P(p,d),P(e,s)),u=g(s,e),L=Math.min(b(t[12].visibility,t[11].visibility,t[23].visibility),b(t[11].visibility,t[13].visibility));let w=1/0,a=1/0,M=1/0;if(L>=R){const f=l(t[12].point,t[11].point,t[23].point,t[11].point,t[11].point,t[13].point);w=c(f,this.isLeft?this.shoulderLocalDir:this.shoulderLocalDirMirror),a=c(A,this.isLeft?this.trunkViewUp:this.trunkViewUpMirror),M=c(u,this.isLeft?this.trunkViewRight:this.trunkViewRightMirror)}const W=Math.min(b(t[11].visibility,t[12].visibility,t[24].visibility),b(t[12].visibility,t[14].visibility));let k=1/0,v=1/0,V=1/0;if(W>=R){const f=l(t[11].point,t[12].point,t[24].point,t[12].point,t[12].point,t[14].point);k=c(f,this.isLeft?this.shoulderLocalDirMirror:this.shoulderLocalDir),v=c(A,this.isLeft?this.trunkViewUpMirror:this.trunkViewUp),V=c(u,this.isLeft?this.trunkViewRightMirror:this.trunkViewRight)}return w<k&&w<=Yi&&a<=Ui&&M<=Ui?{score:(Math.PI-w)*(Math.PI-a)*(Math.PI-M),center:r[11].point,related:[r[12].point,r[13].point,P(r[23].point,r[11].point)],flip:!this.isLeft}:k<=Yi&&v<=Ui&&V<=Ui?{score:(Math.PI-k)*(Math.PI-v)*(Math.PI-V),center:r[12].point,related:[r[11].point,r[14].point,P(r[24].point,r[12].point)],flip:this.isLeft}:null}}const Ki=Math.PI/180*30;class Ji{constructor(i){h(this,"isLeft");h(this,"shoulderLocalDir",[0,0,0]);h(this,"shoulderLocalDirMirror",[0,0,0]);this.isLeft=i}prepare(i){this.isLeft?(this.shoulderLocalDir=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition),this.shoulderLocalDirMirror=l(i.rightUpperArm.originWorldPosition,i.leftUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.leftUpperArm.originWorldPosition,i.leftUpperArm.controlPointWorldPosition,!0)):(this.shoulderLocalDir=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition),this.shoulderLocalDirMirror=l(i.leftUpperArm.originWorldPosition,i.rightUpperArm.originWorldPosition,i.trunk.originWorldPosition,i.trunk.controlPointWorldPosition,i.rightUpperArm.originWorldPosition,i.rightUpperArm.controlPointWorldPosition,!0))}match(i){const t=i.worldLandmarks,r=i.normalizedLandmarks,n=i.width/i.height,e=y(r[11].point,n),s=y(r[12].point,n),p=y(r[23].point,n),d=y(r[24].point,n);g(P(p,d),P(e,s)),g(s,e);const A=Math.min(b(t[12].visibility,t[11].visibility,t[23].visibility),b(t[11].visibility,t[13].visibility));let u=1/0;if(A>=R){const a=l(t[12].point,t[11].point,t[23].point,t[11].point,t[11].point,t[13].point);u=c(a,this.isLeft?this.shoulderLocalDir:this.shoulderLocalDirMirror)}const L=Math.min(b(t[11].visibility,t[12].visibility,t[24].visibility),b(t[12].visibility,t[14].visibility));let w=1/0;if(L>=R){const a=l(t[11].point,t[12].point,t[24].point,t[12].point,t[12].point,t[14].point);w=c(a,this.isLeft?this.shoulderLocalDirMirror:this.shoulderLocalDir)}return u<w&&u<=Ki?{score:Math.PI-u,center:r[11].point,related:[r[12].point,r[13].point,P(r[23].point,r[11].point)],flip:!this.isLeft}:w<=Ki?{score:Math.PI-w,center:r[12].point,related:[r[11].point,r[14].point,P(r[24].point,r[12].point)],flip:this.isLeft}:null}}function hr(o,i,t){const r=[];return t.prepare(i),o.forEach(n=>{const e=t.match(n);e!=null&&r.push(Ei(Di({},e),{photo:n}))}),r.sort((n,e)=>-n.score+e.score),r}const Ri={Chest:{matcher:new sr,highlights:[T.trunk]},"Left Shoulder":{matcher:new ji(!0),cameraUnrelatedMatcher:new Ji(!0),highlights:[T.trunk,T.leftUpperArm]},"Right Shoulder":{matcher:new ji(!1),cameraUnrelatedMatcher:new Ji(!1),highlights:[T.trunk,T.rightUpperArm]},"Left Elbow":{matcher:new Zi(!0),cameraUnrelatedMatcher:new xi(!0),highlights:[T.leftUpperArm,T.leftLowerArm]},"Right Elbow":{matcher:new Zi(!1),cameraUnrelatedMatcher:new xi(!1),highlights:[T.rightUpperArm,T.rightLowerArm]},Crotch:{matcher:new lr,highlights:[T.trunk]},"Left Hip":{matcher:new Hi(!0),cameraUnrelatedMatcher:new Gi(!0),highlights:[T.trunk,T.leftThigh]},"Right Hip":{matcher:new Hi(!1),cameraUnrelatedMatcher:new Gi(!1),highlights:[T.trunk,T.rightThigh]},"Left Knee":{matcher:new qi(!0),cameraUnrelatedMatcher:new Bi(!0),highlights:[T.leftThigh,T.leftCalf]},"Right Knee":{matcher:new qi(!1),cameraUnrelatedMatcher:new Bi(!1),highlights:[T.rightThigh,T.rightCalf]}};var ar=wi({components:{NButton:ht,NSelect:at,NRadio:ct,NRadioGroup:gt,NIcon:Ci,WarningOutlined:Ct,SkeletonModelCanvas:vt,ImageClip:xt,ImageViewer:or},setup(){const o=nr(),i=er(),t=new mt,r=new Vt,n=new yt,e=D(),s=D(!1),p=Object.keys(Ri).map(f=>({value:f,label:f})),d=D(),A=D(0),u=D(1),L=D(!1);let w=[];const a=D(),M=D(!1),W=D(!1),k=D(new _t);Si(async function(){try{s.value=!0,await pt(),await t.init(),w=t.queryAllPhotos()}finally{s.value=!1}});function v(){try{L.value=!0,a.value=[];const f=Ri[d.value];if(f){let F=w;A.value&&(F=F.filter(E=>E.gender===A.value));const N=!u.value&&f.cameraUnrelatedMatcher?f.cameraUnrelatedMatcher:f.matcher;a.value=hr(F,r,N).slice(0,bt),e.value.scrollTop=0}}finally{L.value=!1}}function V(f){M.value=!0,W.value=f.flip,k.value=f.photo}return{supportWebGL2:o,supportMouse:i,matchers:Ri,model:r,camera:n,searchResultDom:e,dbLoading:s,bodyPartOptions:p,bodyPart:d,gender:A,cameraRelated:u,searchResult:a,searching:L,showImageViewer:M,imageViewerFlip:W,currentPhoto:k,search:v,showLargePhoto:V}}});const cr={class:"container cols"},gr={class:"rows",style:{width:"320px",height:"100%",overflow:"auto"}},pr={class:"cols search-condition"},ur=x(" Search "),fr={class:"cols search-condition"},Pr=m("label",null,"Gender",-1),wr=x("Any"),dr=x("Male"),Ar=x("Female"),Lr={class:"cols search-condition"},Mr=m("label",null,"Camera",-1),Wr=x("Related"),kr=x("Ignored"),vr=m("div",{class:"description"},[m("div",null,"Wheel: Rotate Camera / Zoom"),m("div",null,"Mouse Right: Move Camera"),m("div",null,"Shift + Mouse Left: Rotate Joint")],-1),yr=wt('<div style="width:100%;height:1px;background:#d9d9d9;margin:6px 0;"></div><div class="description"><div>Author: x6udpngx</div><div><a href="https://github.com/x6ud/x6ud.github.io/issues" target="_blank">Leave a message</a></div><div><a href="https://github.com/x6ud/pose-search" target="_blank">Source code</a></div><div><span>Support me:\xA0</span><a href="https://ko-fi.com/x6udpngx" target="_blank">Ko-fi.com/x6udpngx</a></div></div>',2),Vr={class:"fill"},br={class:"result",style:{width:"100%",height:"100%",overflow:"auto"},ref:"searchResultDom"},Ur={key:0,class:"loading"},mr={key:1,class:"warning",style:{"font-size":"16px"}},_r={key:0},Ir=x(" This page requires WebGL2 but your system does not seem to support. Try updating your graphics card drivers or changing your browser. "),Rr={key:1},Tr=x(" This page currently supports mouse operation only. ");function Dr(o,i,t,r,n,e){var W,k,v,V;const s=C("n-select"),p=C("n-button"),d=C("n-radio"),A=C("n-radio-group"),u=C("skeleton-model-canvas"),L=C("warning-outlined"),w=C("n-icon"),a=C("image-clip"),M=C("image-viewer");return S(),X($i,null,[m("div",cr,[m("div",gr,[m("div",pr,[_(s,{class:"fill",size:"small",placeholder:"Joint / Body Part",filterable:"",clearable:"",options:o.bodyPartOptions,loading:o.dbLoading,value:o.bodyPart,"onUpdate:value":i[0]||(i[0]=f=>o.bodyPart=f)},null,8,["options","loading","value"]),_(p,{size:"small",type:"primary",onClick:o.search,disabled:!o.bodyPart||o.searching},{default:Z(()=>[ur]),_:1},8,["onClick","disabled"])]),m("div",fr,[Pr,_(A,{size:"small",value:o.gender,"onUpdate:value":i[1]||(i[1]=f=>o.gender=f)},{default:Z(()=>[_(d,{value:0},{default:Z(()=>[wr]),_:1}),_(d,{value:1},{default:Z(()=>[dr]),_:1}),_(d,{value:2},{default:Z(()=>[Ar]),_:1})]),_:1},8,["value"])]),ut(m("div",Lr,[Mr,_(A,{size:"small",value:o.cameraRelated,"onUpdate:value":i[2]||(i[2]=f=>o.cameraRelated=f)},{default:Z(()=>[_(d,{value:1},{default:Z(()=>[Wr]),_:1}),_(d,{value:0},{default:Z(()=>[kr]),_:1})]),_:1},8,["value"])],512),[[ft,(W=o.matchers[o.bodyPart])==null?void 0:W.cameraUnrelatedMatcher]]),vr,_(u,{style:{width:"100%",height:"400px","min-height":"400px"},model:o.model,camera:o.camera,highlights:(k=o.matchers[o.bodyPart])==null?void 0:k.highlights},null,8,["model","camera","highlights"]),yr]),m("div",Vr,[m("div",br,[o.dbLoading&&!((v=o.searchResult)==null?void 0:v.length)?(S(),X("div",Ur," Loading database, this may take more than 10 seconds ")):ni("",!0),!((V=o.searchResult)==null?void 0:V.length)&&(!o.supportWebGL2||!o.supportMouse)?(S(),X("div",mr,[o.supportWebGL2?ni("",!0):(S(),X("div",_r,[_(w,null,{default:Z(()=>[_(L)]),_:1}),Ir])),o.supportMouse?ni("",!0):(S(),X("div",Rr,[_(w,null,{default:Z(()=>[_(L)]),_:1}),Tr]))])):ni("",!0),(S(!0),X($i,null,Pt(o.searchResult,f=>(S(),di(a,{class:"photo",src:f.photo.regular,width:200,height:200,"img-width":f.photo.width,"img-height":f.photo.height,center:f.center,related:f.related,landmarks:f.photo.normalizedLandmarks,flip:f.flip,onClick:F=>o.showLargePhoto(f)},null,8,["src","img-width","img-height","center","related","landmarks","flip","onClick"]))),256))],512)])]),_(M,{show:o.showImageViewer,"onUpdate:show":i[3]||(i[3]=f=>o.showImageViewer=f),id:o.currentPhoto.id,regular:o.currentPhoto.regular,full:o.currentPhoto.full,flip:o.imageViewerFlip,"author-name":o.currentPhoto.authorName,"author-username":o.currentPhoto.authorUsername},null,8,["show","id","regular","full","flip","author-name","author-username"])],64)}var zr=Ii(ar,[["render",Dr]]);export{zr as default};
//# sourceMappingURL=Search.4a5f5d87.js.map
